Object.mix(namespace("DeskApc.AppRandom"),function(){function a(a){var b=[],c=parseInt(a*Math.random());return b.contains(c)?!1:(b.push(c),c)}function b(b,c,d,e,f,g){b=b||!1,e=e||"3",g=g||"",f=f||!1,c=c||"data-random",d=d||"data-textarea-random";if(!W("."+c).length){var h=document.createElement("div"),i=W("."+d);h.innerHTML=i.val();var j=W(h).query("."+c),k=j.length,l=[];for(var m=0;m<k;m++)l.push(m);for(var m=0;m<e;m++){var n=parseInt(Math.random()*l.length),o=l.splice(n,1);f||(o=m);var p=j.item(o),q=p.query(".data-el"),r=q.length;if(g){var s=[];for(var t=0;t<g;t++)s.push(t);var u=document.createElement("div"),v="";for(var t=0;t<g;t++){var w=parseInt(Math.random()*s.length),x=s.splice(w,1);v+=p.query(".data-el").item(x).outerHTML()}W(u).html(v),p.query(".data-el").removeNode();var y=W(u).query(".data-el");y.forEach(function(a,b){p.appendChild(a)}),r=g,q=p.query(".data-el")}for(var t=0;t<r;t++)q.forEach(function(b,c){b=W(b);var d=b.attr("data-sort"),e=b.attr("data-random");if(d)d-1==t?b.parentNode().insertBefore(b[0],p.query(".data-el").item(t)):b.parentNode().insertAfter(b[0],p.query(".data-el").item(d-1));else if(e){var f=a(r);f&&(p.query(".data-el").item(f).attr("data-sort")||b.parentNode().insertBefore(b[0],p.query(".data-el").item(f)))}});if(b){var z=Dom.insertSiblingBefore(p,'<textarea class="data-tab-textarea" style="display:none;"></textarea>');W(z).val(p.outerHTML()),p.removeNode(!0),i.parentNode().insertBefore(W(z),i)}else i.parentNode().insertBefore(p,i)}i.removeNode(!0)}}return{init:b}}());Object.mix(namespace("DeskApc.FocusPic"),function(){function a(){this.style={on:"data-on",out:"data-out"},this.autoPlay=!0,this.playTime=2e3,this.timer=null,this.curIndex=0,this.holder=W(".data-focus-holder"),this.picBig=this.holder.query(".data-focus-picBig"),this.picLittle=this.holder.query(".data-focus-picLittle"),this.img=this.picBig.query(".data-focus-img"),this.len=this.picLittle.length}return a.prototype={init:function(){var a=this;a.changeMenu(0),this.picLittle.forEach(function(b,d){b=W(b),b.on("mouseover",function(){a.stopChange()}).on("mouseout",function(){a.autoChange()}).on("click",function(){a.changeMenu(d)}),a.picBig.item(d).on("mouseover",function(){a.stopChange()}).on("mouseout",function(){a.autoChange()})}),a.autoPlay&&a.autoChange()},autoChange:function(){var a=this;clearInterval(a.timer),a.autoPlay&&(this.timer=window.setInterval(function(){a.changeMenu()},a.playTime))},stopChange:function(){clearInterval(this.timer)},changeMenu:function(a){typeof a!="undefined"?this.curIndex=a:this.curIndex<this.len-1?this.curIndex++:this.curIndex=0;for(var b=0;b<this.len;b++)this.curIndex==b?(this.picBig.item(b).css("display","block"),this.picLittle.item(b).replaceClass(this.style.out,this.style.on),!this.img.item(b).attr("src")&&this.img.item(b).attr("data-focus-src")&&(this.img.item(b).attr("src",this.img.item(b).attr("data-focus-src")),this.img.item(b).removeAttr("data-focus-src"))):(this.picBig.item(b).css("display","none"),this.picLittle.item(b).replaceClass(this.style.on,this.style.out))}},{init:a}}());var PicLazyUtil=function(){function e(a){for(var b={top:0,left:0};a;)b.top+=a.offsetTop,b.left+=a.offsetLeft,a=a.offsetParent;return b}function f(){window.clearTimeout(c),c=window.setTimeout(a.testImgs,100)}var a={},b=[],c=null,d;a.NeedPicLazyUtil=!0,a.pushImgs=function(){var a=document.getElementsByTagName("img");for(var c=0;c<a.length;c++)a[c].getAttribute("_src")&&!a[c].getAttribute("__lazyPushed")&&(b.push(a[c]),a[c].setAttribute("__lazyPushed",1))},a.testImgs=function(){if(b.length==0||!a.NeedPicLazyUtil)return;var c={};d?(c.top=d.scrollTop,c.left=d.scrollLeft,c.bottom=c.top+d.clientHeight,c.right=c.left+d.clientWidth):(c.top=document.body.scrollTop+document.documentElement.scrollTop,c.left=document.documentElement.scrollLeft,c.bottom=c.top+document.documentElement.clientHeight,c.right=c.left+document.documentElement.clientWidth);for(var f=0;f<b.length;f++){var g=b[f];if(!g.offsetWidth)continue;var h=g.clientWidth,i=g.clientHeight,j=e(g);if(j.top>=c.top&&j.top<=c.bottom&&j.left>=c.left&&j.left<=c.right||j.top+i>=c.top&&j.top<=c.bottom&&j.left+h>=c.left&&j.left<=c.right)typeof DD_belatedPNG!="undefined"&&typeof window.PicLazyUtilRewrite!="undefined"?window.PicLazyUtilRewrite(g):(g.src=g.getAttribute("_src"),g.removeAttribute("_src")),b.splice(f,1),f--}};var g=!1;return a.init=function(){a.pushImgs(),a.testImgs();if(!g){g=!0;var b,c=document.getElementById("data-lazyload-holder");c?(b=c,d=c):b=window,b.addEventListener?(b.addEventListener("scroll",f,!1),b.addEventListener("resize",f,!1)):b.attachEvent?(b.attachEvent("onscroll",f),b.attachEvent("onresize",f)):(b.onscroll=f,b.onresize=f)}},a}();Object.mix(namespace("DeskApc.BaikeList"),function(){function c(b){var c=b.join("|||"),e=a+"?ks="+encodeURIComponent(c)+"&ofmt=json&ienc=utf8";QW.loadJsonp(e,function(a){d(a)})}function d(a){for(var c in a){var d=a[c].good_rate,e=W(b+"[data-bkname='"+c+"']"),f=e.hasClass("data-bkcon")?e:e.query(".data-bkcon");f.length&&f.show();var g=e.hasClass("data-bkper")?e:e.query(".data-bkper");g.length>0&&g.setStyle("width",d+"%"),d%100==0?d=(d/10).toString():d=(d/10).toFixed(1);var h=e.hasClass("data-bkscore")?e:e.query(".data-bkscore");h.length>0&&h.html(d+"\u5206")}}function e(a){a.holder&&(b=a.holder);var d=0;while(d<=10){var e=[];for(i=0;i<20;i++){if(a.datas.length==0)break;e.push(a.datas.shift())}c(e),d++;if(a.datas[0]==null)break}}function f(a,b){a=a||W(document.body);var c=a.query(".data-key");c.length||a.item(0)&&a.item(0).hasClass("data-key")&&(c=a);if(!c)return;if(c.length!=0){var d=[];c.forEach(function(a){a=W(a);var b=a.attr("data-bkname");b&&d.push(b)}),d.length!=0&&e({datas:d,holder:b||".data-key"})}}var a="//q.soft.360.cn/get_polls.php",b="";return{init:f}}());Object.mix(namespace("DeskApc.AppDownload"),function(){function f(a){for(var c in a)b.push(new Array(c,parseInt(a[c])))}function g(a){for(var b in a)n({id:b,status:a[b]})}function h(a){for(var b in a)o({id:b,status:a[b]})}function i(){a=window.setInterval(function(){j()},200)}function j(){var f=b.length;if(f==0){if(d){if(e>30){clearInterval(a);return}e++;return}clearInterval(a);return}d=!1;for(var g=0;g<c;g++)try{k({id:b[g][0],status:b[g][1]})}catch(h){continue}b.splice(0,c)}function k(a){var b=a.id;switch(a.status){case 1:n({id:b,status:2,type:"init"})}}function l(a){var b=W("#data-"+a),c=b.hasClass("data-add")?b.attr("__dtype")||"app_download":b.query(".data-add").attr("__dtype")||"app_download",d=b.hasClass("data-add")?b.attr("rtype"):b.query(".data-add").attr("rtype"),e=b.hasClass("data-add")?b.attr("rext"):b.query(".data-add").attr("rext"),f=c+"|"+a,g=2;d&&(f+="|"+d,g++,e&&(f+="|"+e,g++)),window.external.SoftMgr_Notify(g,f)}function m(a){var b="showApp|"+a;window.external.SoftMgr_Notify(2,b)}function n(a){var b=a.id,c=parseInt(a.status),d=a.type,e=W("#data-"+b),f=e.hasClass("data-add")?e:e.query(".data-add"),g=e.query(".data-loading"),h=g.query(".data-cancel"),i=f.attr("data-add-style"),j=f.attr("data-open-style"),k=f.attr("data-adding-style"),l=f.attr("data-add-text"),m=f.attr("data-open-text"),n=f.attr("data-load-show");switch(c){case 0:g.hide(),l&&f.attr("tagName").toLowerCase()!="input"&&f.html(l),f.show().attr("__dtype","app_download").replaceClass(k||i,i);break;case 1:break;case 2:g.hide(),m&&f.attr("tagName").toLowerCase()!="input"&&f.html(m),f.show().attr("__dtype","openApp").replaceClass(d=="init"?i:k||i,j);break;case 3:k?f.show().replaceClass(i,k):(n!="1"&&f.hide(),g.show(),h.on("click",function(a){var c="cancel|"+b;window.external.SoftMgr_Notify(2,c),a.preventDefault()}))}}function o(a){var b=a.id,c=a.status,d=W("#data-"+b);c>100&&(c=100),d.query(".data-per").css("width",c+"%"),d.query(".data-per-text").html(c+"%")}function p(a,b,c,d){if(typeof moniter!="undefined"){var e=window.location.href+"#"+c+d;a.attr("href")?a.attr("href",e):b.hasClass("data-stat-map")?b.attr("href",e):b.query(".data-stat-map").length&&b.query(".data-stat-map").attr("href",e)}}function q(a){var b=W(this),c=b.hasClass("data-key")?b:b.parentNode(".data-key"),d=c.get("id").replace("data-","");if(!c.length||!d)return;p(b,c,d,"_add"),l(d),a.preventDefault()}function r(a){var b=W(this),c=b.hasClass("data-key")?b:b.parentNode(".data-key"),d=c.get("id").replace("data-","");if(!c.length||!d)return;p(b,c,d,"_detail"),m(d),a.preventDefault()}function s(a){a=a||W(document.body);var b=a.query(".data-key"),c=[];if(b.length){b.forEach(function(a){a=W(a);if(a.attr("data-init-status")!="0"){var b=a.get("id").replace("data-","");b&&c.push(b)}}),a.delegate(".data-add,.data-add2,.data-add3","click",q).delegate(".data-detail","click",r);if(c.length!=0){var d="webapp_data|"+c.join(",");try{window.external.SoftMgr_Notify(2,d)}catch(e){}i()}}}var a=null,b=[],c=3,d=!0,e=0;return window.setSoftStatus=f,window.setDownloadStatus=g,window.setDownloadProgress=h,{init:s}}());var BaikeLazyUtil=function(){function e(a){for(var b={top:0,left:0};a;)b.top+=a.offsetTop,b.left+=a.offsetLeft,a=a.offsetParent;return b}function f(){window.clearTimeout(c),c=window.setTimeout(a.testBaikes,100)}var a={},b=[],c=null,d;a.pushBaikeList=function(){var a=W(document.body).query(".data-key");a.length&&a.forEach(function(a){a=W(a);var c=a.attr("data-bkname");c&&(a.attr("__lazyPushed")||(b.push(g(a)),a.attr("__lazyPushed",1)))})},a.testBaikes=function(){if(b.length==0)return;var a={};d?(a.top=d.scrollTop,a.left=d.scrollLeft,a.bottom=a.top+d.clientHeight,a.right=a.left+d.clientWidth):(a.top=document.body.scrollTop+document.documentElement.scrollTop,a.left=document.documentElement.scrollLeft,a.bottom=a.top+document.documentElement.clientHeight,a.right=a.left+document.documentElement.clientWidth);var c=[];for(var f=0;f<b.length;f++){var g=b[f];if(!g.offsetWidth)continue;var h=g.clientWidth,i=g.clientHeight,j=e(g);if(j.top>=a.top&&j.top<=a.bottom&&j.left>=a.left&&j.left<=a.right||j.top+i>=a.top&&j.top<=a.bottom&&j.left+h>=a.left&&j.left<=a.right)c.push(g),b.splice(f,1),f--}c.length!=0&&DeskApc.BaikeList.init(W(c))};var h=!1;return a.init=function(){a.pushBaikeList(),a.testBaikes();if(!h){h=!0;var b,c=document.getElementById("data-lazyload-holder");c?(b=c,d=c):b=window,b.addEventListener?(b.addEventListener("scroll",f,!1),b.addEventListener("resize",f,!1)):b.attachEvent?(b.attachEvent("onscroll",f),b.attachEvent("onresize",f)):(b.onscroll=f,b.onresize=f)}},a}();Object.mix(namespace("DeskApc.TabView"),function(){function a(a){this.style={on:"data-on",out:"data-out"},this.lazyAppDown=!1,this.lazyBaike=!1,this.lazyPic=!1,this.event="click",this.parent=a||W(document.body),this.tabs=this.parent.query(".data-tab-btn"),this.tabsTextarea=this.parent.query(".data-tab-textarea"),this.len=this.tabs.length}return a.prototype={init:function(){var a=this;a.tabs.forEach(function(b,d){b=W(b),b.on(a.event,function(b){b.preventDefault(),a.changeTab(d)})}),a.changeTab(0)},changeTab:function(a){for(var b=0;b<this.len;b++)if(a==b)if(!this.tabsTextarea.item(b).attr("__tabed")){var c=document.createElement("div");c.innerHTML=this.tabsTextarea.item(b).val();var d=W(c).query(".data-tab-con");this.tabsTextarea.item(b).replaceNode(d[0]),this.tabsTextarea.item(b).attr("__tabed",1),this.parent.query(".data-tab-con").item(b).css("display","block"),this.tabs.item(b).addClass(this.style.on),this.lazyAppDown&&b!=0&&DeskApc.AppDownload.init(this.parent.query(".data-tab-con").item(b)),this.lazyBaike&&b!=0&&DeskApc.BaikeList.init(this.parent.query(".data-tab-con").item(b))}else this.parent.query(".data-tab-con").item(b).css("display","block"),this.tabs.item(b).addClass(this.style.on),this.lazyPic&&setTimeout("PicLazyUtil.init()",200);else this.parent.query(".data-tab-con").item(b)&&this.parent.query(".data-tab-con").item(b).css("display","none"),this.tabs.item(b).removeClass(this.style.on)}},{init:a}}());